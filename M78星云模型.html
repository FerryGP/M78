<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M78æ˜Ÿäº‘ä¸çŒæˆ·åº§ï¼š3Dè§†é”™è§‰æ¢ç©¶ (V3.0)</title>
    <!-- å¼•å…¥ Plotly.js åº“ -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        body { margin: 0; padding: 0; background-color: #000; color: white; font-family: 'Arial', sans-serif; overflow: hidden; }
        #chart-container { width: 100vw; height: 100vh; }
        .instruction {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 8px;
            pointer-events: none;
            z-index: 100;
            border: 1px solid #444;
        }
        .instruction h3 { margin-top: 0; color: #87CEFA; }
        .legend-box {
            margin-top: 10px;
            font-size: 12px;
            color: #aaa;
        }
        .legend-item { display: flex; align-items: center; margin-bottom: 4px; }
        .dot { width: 10px; height: 10px; border-radius: 50%; margin-right: 8px; display: inline-block; }
        .highlight { color: #E066FF; font-weight: bold; }
    </style>
</head>
<body>

    <div class="instruction">
        <h3>M78æ˜Ÿäº‘æ¢ç©¶æ¼”ç¤º (V3)</h3>
        <p>1. <b>è§†è§’ä¿®æ­£ï¼š</b>å·²æ ¡å‡†ä¸ºåŒ—äº¬å†¬å­£é¢æœæ­£å—æ–¹çš„è§‚æµ‹è§†è§’ã€‚</p>
        <p>2. <b>å·¦ä¾§ (ä¸œ)ï¼š</b>å‚å®¿å›› (çº¢æ˜Ÿ)ã€M78æ˜Ÿäº‘ã€‚</p>
        <p>3. <b>å³ä¾§ (è¥¿)ï¼š</b>å‚å®¿äº”ã€å‚å®¿ä¸ƒ (æœ€äº®è“æ˜Ÿ)ã€‚</p>
        <div class="legend-box">
            <div class="legend-item"><span class="dot" style="background:#FF4500"></span>çº¢è¶…å·¨æ˜Ÿ (å‚å®¿å››)</div>
            <div class="legend-item"><span class="dot" style="background:#1E90FF"></span>è“å·¨æ˜Ÿ (å‚å®¿ä¸ƒç­‰)</div>
            <div class="legend-item"><span class="dot" style="background:#E066FF"></span>M78 æ˜Ÿäº‘ (æ°”ä½“)</div>
        </div>
    </div>

    <div id="chart-container"></div>

    <script>
        // ==========================================
        // 1. å®šä¹‰å¤©ä½“æ•°æ® (æœ€ç»ˆä¿®æ­£ç‰ˆ V3)
        // ==========================================
        // åæ ‡é€»è¾‘: X(å·¦å³), Y(ä¸Šä¸‹), Z(å…‰å¹´è·ç¦»)
        // ä¿®æ­£è¯´æ˜: ç¿»è½¬Xè½´ï¼Œç¡®ä¿æ­£Xä¸ºå·¦(ä¸œ)ï¼Œè´ŸXä¸ºå³(è¥¿) [æ ¹æ®ç”¨æˆ·åé¦ˆçš„è§†è§‰ä¿®æ­£]
        
        const starsData = [
            ["åœ°çƒ (è§‚å¯Ÿç‚¹)", 0, 0, 0, "green", 4, "observer"],
            
            // --- å·¦ä¾§ (ä¸œæ–¹) ---
            ["å‚å®¿å›› (Betelgeuse)", 2, 4, 640, "#FF4500", 25, "star"],   // å·¦ä¸Š, çº¢è¶…å·¨æ˜Ÿ
            ["å‚å®¿å…­ (Saiph)", 2, -4, 720, "#4169E1", 14, "star"],      // å·¦ä¸‹
            ["å‚å®¿ä¸€ (Alnitak)", 0.8, 0, 800, "#87CEEB", 12, "star"],   // è…°å¸¦å·¦
            
            // --- å³ä¾§ (è¥¿æ–¹) ---
            ["å‚å®¿äº” (Bellatrix)", -2, 4, 250, "#87CEFA", 14, "star"],  // å³ä¸Š
            ["å‚å®¿ä¸ƒ (Rigel)", -2, -4, 860, "#1E90FF", 28, "star"],     // å³ä¸‹, æœ€äº®
            ["å‚å®¿ä¸‰ (Mintaka)", -0.8, 0, 915, "#87CEEB", 12, "star"],  // è…°å¸¦å³
            
            // --- ä¸­é—´ ---
            ["å‚å®¿äºŒ (Alnilam)", 0, 0, 1340, "#87CEEB", 12, "star"]     // è…°å¸¦ä¸­
        ];

        // M78 æ˜Ÿäº‘ä½ç½® 
        // ä¿®æ­£: ä½äºå‚å®¿ä¸€(è…°å¸¦å·¦)çš„æ›´å·¦ä¸Šæ–¹
        const m78Pos = {x: 1.2, y: 1.5, z: 1600};

        // ==========================================
        // 2. æ„å»º Plotly æ•°æ®
        // ==========================================
        const traces = [];

        // --- A. æ’æ˜Ÿä¸è§†çº¿ ---
        starsData.forEach(star => {
            const [name, x, y, z, color, size, type] = star;

            // 1. æ˜Ÿæ˜Ÿæœ¬ä½“
            traces.push({
                x: [x], y: [y], z: [z],
                mode: 'markers+text',
                marker: { size: size, color: color, opacity: 1, line: {color: 'white', width: 1} },
                text: [name],
                textposition: "top center",
                textfont: { color: "white", size: 13 },
                type: 'scatter3d',
                name: name,
                hoverinfo: 'text+z'
            });

            // 2. è§†çº¿
            if (type !== "observer") {
                traces.push({
                    x: [0, x], y: [0, y], z: [0, z],
                    mode: 'lines',
                    line: { color: 'gray', width: 1, dash: 'dot' },
                    type: 'scatter3d',
                    showlegend: false,
                    hoverinfo: 'none',
                    opacity: 0.15
                });
            }
        });

        // --- B. M78 æ˜Ÿäº‘ (ç²’å­é›¾æ°”) ---
        const cloudX = [], cloudY = [], cloudZ = [];
        for(let i=0; i<100; i++) {
            cloudX.push(m78Pos.x + (Math.random()-0.5) * 1.8);
            cloudY.push(m78Pos.y + (Math.random()-0.5) * 1.8);
            cloudZ.push(m78Pos.z + (Math.random()-0.5) * 150); 
        }
        
        traces.push({
            x: cloudX, y: cloudY, z: cloudZ,
            mode: 'markers',
            marker: { size: 5, color: '#E066FF', opacity: 0.5 },
            type: 'scatter3d',
            name: 'M78æ˜Ÿäº‘é›¾æ°”',
            hoverinfo: 'none',
            showlegend: false
        });

        // M78 æ ‡ç­¾
        traces.push({
            x: [m78Pos.x], y: [m78Pos.y], z: [m78Pos.z],
            mode: 'markers+text',
            marker: { size: 50, color: 'purple', opacity: 0.2 },
            text: ["<b>M78 æ˜Ÿäº‘</b><br>(æ°”ä½“ 1600å…‰å¹´)"],
            textposition: "top center",
            textfont: { color: "#E066FF", size: 18 },
            type: 'scatter3d',
            name: 'M78 æ˜Ÿäº‘',
            hoverinfo: 'text+z'
        });

        traces.push({
            x: [0, m78Pos.x], y: [0, m78Pos.y], z: [0, m78Pos.z],
            mode: 'lines',
            line: { color: '#E066FF', width: 2, dash: 'dot' },
            type: 'scatter3d',
            showlegend: false,
            opacity: 0.4
        });

        // --- C. çŒæˆ·åº§è¿çº¿ ---
        // å¯¹ç…§: 0:åœ°çƒ, 1:å‚å®¿å››(å·¦ä¸Š), 2:å‚å®¿å…­(å·¦ä¸‹), 3:å‚å®¿ä¸€(å·¦è…°), 4:å‚å®¿äº”(å³ä¸Š), 5:å‚å®¿ä¸ƒ(å³ä¸‹), 6:å‚å®¿ä¸‰(å³è…°), 7:å‚å®¿äºŒ(ä¸­è…°)
        const connections = [
            [1, 4], // è‚©è†€è¿çº¿ (å·¦è‚©-å³è‚©)
            [1, 3], // å·¦è‚© -> è…°å¸¦å·¦ (å‚å®¿å››-å‚å®¿ä¸€)
            [4, 6], // å³è‚© -> è…°å¸¦å³ (å‚å®¿äº”-å‚å®¿ä¸‰)
            [3, 2], // è…°å¸¦å·¦ -> å·¦è„š (å‚å®¿ä¸€-å‚å®¿å…­)
            [6, 5], // è…°å¸¦å³ -> å³è„š (å‚å®¿ä¸‰-å‚å®¿ä¸ƒ)
            [3, 7], // è…°å¸¦ 1-2
            [7, 6]  // è…°å¸¦ 2-3
        ];

        connections.forEach(pair => {
            const s = starsData[pair[0]];
            const e = starsData[pair[1]];
            traces.push({
                x: [s[1], e[1]], y: [s[2], e[2]], z: [s[3], e[3]],
                mode: 'lines',
                line: { color: 'white', width: 4 },
                type: 'scatter3d',
                showlegend: false,
                hoverinfo: 'none'
            });
        });

        // ==========================================
        // 3. å¸ƒå±€è®¾ç½®
        // ==========================================
        const layout = {
            title: {
                text: 'M78æ˜Ÿäº‘ä¸çŒæˆ·åº§ï¼š3Dæ¨¡å‹ (V3.0)',
                font: { color: 'white', size: 24 }
            },
            paper_bgcolor: 'black',
            plot_bgcolor: 'black',
            showlegend: false,
            scene: {
                xaxis: { title: '', range: [-5, 5], showgrid: false, zeroline: false, showticklabels: false },
                yaxis: { title: '', range: [-5, 5], showgrid: false, zeroline: false, showticklabels: false },
                zaxis: { 
                    title: 'è·ç¦»åœ°çƒ (å…‰å¹´)', 
                    range: [0, 1800], 
                    showgrid: true, 
                    gridcolor: '#333', 
                    zerolinecolor: '#666',
                    color: '#aaa' 
                },
                aspectmode: 'manual',
                aspectratio: { x: 1, y: 1, z: 2.5 }, 
                camera: {
                    eye: { x: 0, y: 0, z: -0.1 }, 
                    up: { x: 0, y: 1, z: 0 }
                }
            },
            updatemenus: [{
                type: 'buttons',
                direction: 'left',
                x: 0.05, y: 0.05, xanchor: 'left',
                font: { color: 'black' },
                bgcolor: '#f0f0f0',
                bordercolor: '#ccc',
                borderwidth: 1,
                buttons: [
                    {
                        label: "ğŸŒ åŒ—äº¬è§‚æµ‹è§†è§’ (åœ°çƒ)",
                        method: "relayout",
                        args: [{
                            "scene.camera.eye": { x: 0.001, y: 0.001, z: -0.1 },
                            "scene.camera.up": { x: 0, y: 1, z: 0 },
                            "scene.camera.center": { x: 0, y: 0, z: 0 },
                            "title.text": "åŒ—äº¬è§‚æµ‹ï¼šå·¦ä¸Šå‚å®¿å››(çº¢)ï¼Œå³ä¸Šå‚å®¿äº”(è“)"
                        }]
                    },
                    {
                        label: "ğŸ›¸ ä¾§é¢çœŸç›¸ (è·ç¦»)",
                        method: "relayout",
                        args: [{
                            "scene.camera.eye": { x: -2.2, y: 0.2, z: 0.2 }, // ç¨å¾®æ¢ä¸ªä¾§é¢è§’åº¦æ–¹ä¾¿çœ‹
                            "scene.camera.center": { x: 0, y: 0, z: 0 },
                            "scene.camera.up": { x: 0, y: 1, z: 0 },
                            "title.text": "çœŸç›¸ï¼šM78(ç´«è‰²) ç¦»æˆ‘ä»¬æœ‰1600å…‰å¹´ï¼"
                        }]
                    }
                ]
            }]
        };

        Plotly.newPlot('chart-container', traces, layout, {responsive: true});

    </script>
</body>
</html>